#!/usr/bin/make
# Automatically generated by KiBot from `tec-1.kibot.yaml`
KIBOT=kibot
DEBUG=
CONFIG=tec-1.kibot.yaml
SCH=tec-1.sch
PCB=tec-1.kicad_pcb
DEST=.
KIBOT_CMD=$(KIBOT) $(DEBUG) -c $(CONFIG) -e $(SCH) -b $(PCB) -d $(DEST)
LOGFILE=kibot_error.log

#
# Default target
#
all: run_erc update_xml run_drc gerbers drills bom JLCPCB_position sch_svg sch_pdf pcb_svg_f pcb_svg_b pcb_pdf_f pcb_pdf_b ibom step dxf gerber-zip-file

#
# SCH/PCB targets
#
pre_sch: run_erc update_xml

out_sch: bom sch_svg sch_pdf

all_sch: pre_sch out_sch

pre_pcb: run_drc

out_pcb: gerbers drills JLCPCB_position pcb_svg_f pcb_svg_b pcb_pdf_f pcb_pdf_b ibom step dxf gerber-zip-file

all_pcb: pre_pcb out_pcb

#
# Available targets (outputs)
#
run_erc: tec-1-Apr2021.txt

update_xml: tec-1.xml

run_drc: tec-1-Apr2021.txt

gerbers: gerber/tec-1-F_Cu.gbr gerber/tec-1-B_Cu.gbr gerber/tec-1-F_Adhes.gbr gerber/tec-1-B_Adhes.gbr gerber/tec-1-F_Paste.gbr gerber/tec-1-B_Paste.gbr gerber/tec-1-F_SilkS.gbr gerber/tec-1-B_SilkS.gbr gerber/tec-1-F_Mask.gbr gerber/tec-1-B_Mask.gbr gerber/tec-1-F_CrtYd.gbr gerber/tec-1-B_CrtYd.gbr gerber/tec-1-F_Fab.gbr gerber/tec-1-B_Fab.gbr

drills: gerber/tec-1-Apr2021.drl

bom: bom/tec-1-jlc-Apr2021.csv

JLCPCB_position: tec-1_cpl_jlc.csv tec-1_cpl_jlc.csv

sch_svg: doc/tec-1-sch-Apr2021.svg

sch_pdf: doc/tec-1-sch-Apr2021.pdf

pcb_svg_f: doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg

pcb_svg_b: doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg

pcb_pdf_f: doc/tec-1-front-Apr2021.pdf

pcb_pdf_b: doc/tec-1-back-Apr2021.pdf

ibom: bom/tec-1-Apr2021.html

step: 3d/tec-1-Apr2021.step

dxf: dxf/tec-1-Apr2021.dxf dxf/tec-1-Apr2021.dxf

gerber-zip-file: tec-1-Apr2021-2021-04-15-07-25-41.zip

#
# Rules and dependencies
#
tec-1-Apr2021.txt: tec-1-displays.sch tec-1-keybd.sch tec-1.sch tec-1.kibot.yaml
	@$(KIBOT_CMD) -s update_xml,run_drc -i 2>> $(LOGFILE)

tec-1.xml: tec-1-displays.sch tec-1-keybd.sch tec-1.sch tec-1.kibot.yaml
	@$(KIBOT_CMD) -s run_erc,run_drc -i 2>> $(LOGFILE)

tec-1-Apr2021.txt: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s update_xml,run_erc -i 2>> $(LOGFILE)

gerber/tec-1-F_Cu.gbr gerber/tec-1-B_Cu.gbr gerber/tec-1-F_Adhes.gbr gerber/tec-1-B_Adhes.gbr gerber/tec-1-F_Paste.gbr gerber/tec-1-B_Paste.gbr gerber/tec-1-F_SilkS.gbr gerber/tec-1-B_SilkS.gbr gerber/tec-1-F_Mask.gbr gerber/tec-1-B_Mask.gbr gerber/tec-1-F_CrtYd.gbr gerber/tec-1-B_CrtYd.gbr gerber/tec-1-F_Fab.gbr gerber/tec-1-B_Fab.gbr: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all gerbers 2>> $(LOGFILE)

gerber/tec-1-Apr2021.drl: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all drills 2>> $(LOGFILE)

bom/tec-1-jlc-Apr2021.csv: tec-1-displays.sch tec-1-keybd.sch tec-1.sch tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all bom 2>> $(LOGFILE)

# Pick and place file, JLCPCB style
tec-1_cpl_jlc.csv tec-1_cpl_jlc.csv: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all JLCPCB_position 2>> $(LOGFILE)

doc/tec-1-sch-Apr2021.svg: tec-1-displays.sch tec-1-keybd.sch tec-1.sch tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all sch_svg 2>> $(LOGFILE)

doc/tec-1-sch-Apr2021.pdf: tec-1-displays.sch tec-1-keybd.sch tec-1.sch tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all sch_pdf 2>> $(LOGFILE)

doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg doc/tec-1-front-Apr2021.svg: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all pcb_svg_f 2>> $(LOGFILE)

doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg doc/tec-1-back-Apr2021.svg: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all pcb_svg_b 2>> $(LOGFILE)

doc/tec-1-front-Apr2021.pdf: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all pcb_pdf_f 2>> $(LOGFILE)

doc/tec-1-back-Apr2021.pdf: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all pcb_pdf_b 2>> $(LOGFILE)

bom/tec-1-Apr2021.html: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all ibom 2>> $(LOGFILE)

3d/tec-1-Apr2021.step: tec-1.kicad_pcb /usr/share/kicad/modules/packages3d/Package_DIP.3dshapes/DIP-28_W15.24mm.wrl /usr/share/kicad/modules/packages3d/Package_TO_SOT_SMD.3dshapes/SOT-23.wrl /usr/share/kicad/modules/packages3d/Oscillator.3dshapes/Oscillator_DIP-14.wrl /usr/share/kicad/modules/packages3d/Connector_PinHeader_2.54mm.3dshapes/PinHeader_1x09_P2.54mm_Vertical.wrl /usr/share/kicad/modules/packages3d/Connector_PinHeader_2.54mm.3dshapes/PinHeader_1x16_P2.54mm_Horizontal.wrl /usr/share/kicad/modules/packages3d/Package_SO.3dshapes/SOIC-20W_7.5x12.8mm_P1.27mm.wrl /usr/share/kicad/modules/packages3d/Package_DIP.3dshapes/DIP-20_W7.62mm.wrl /usr/share/kicad/modules/packages3d/Connector_PinHeader_2.54mm.3dshapes/PinHeader_1x17_P2.54mm_Vertical.wrl /usr/share/kicad/modules/packages3d/Capacitor_Tantalum_SMD.3dshapes/CP_EIA-7343-31_Kemet-D.wrl /usr/share/kicad/modules/packages3d/Capacitor_SMD.3dshapes/C_0805_2012Metric.wrl /usr/share/kicad/modules/packages3d/Package_DIP.3dshapes/DIP-40_W15.24mm.wrl /usr/share/kicad/modules/packages3d/Package_DIP.3dshapes/DIP-8_W7.62mm.wrl /usr/share/kicad/modules/packages3d/Connector_PinHeader_2.54mm.3dshapes/PinHeader_1x02_P2.54mm_Vertical.wrl /usr/share/kicad/modules/packages3d/Package_SO.3dshapes/SSOP-28_5.3x10.2mm_P0.65mm.wrl /usr/share/kicad/modules/packages3d/Resistor_SMD.3dshapes/R_0805_2012Metric.wrl /usr/share/kicad/modules/packages3d/Inductor_SMD.3dshapes/L_0805_2012Metric.wrl /usr/share/kicad/modules/packages3d/LED_SMD.3dshapes/LED_0805_2012Metric.wrl tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all step 2>> $(LOGFILE)

dxf/tec-1-Apr2021.dxf dxf/tec-1-Apr2021.dxf: tec-1.kicad_pcb tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all dxf 2>> $(LOGFILE)

tec-1-Apr2021-2021-04-15-07-25-41.zip: gerber/tec-1-F_Cu.gbr gerber/tec-1-B_Cu.gbr gerber/tec-1-F_Adhes.gbr gerber/tec-1-B_Adhes.gbr gerber/tec-1-F_Paste.gbr gerber/tec-1-B_Paste.gbr gerber/tec-1-F_SilkS.gbr gerber/tec-1-B_SilkS.gbr gerber/tec-1-F_Mask.gbr gerber/tec-1-B_Mask.gbr gerber/tec-1-F_CrtYd.gbr gerber/tec-1-B_CrtYd.gbr gerber/tec-1-F_Fab.gbr gerber/tec-1-B_Fab.gbr gerber/tec-1-Apr2021.drl tec-1.kibot.yaml
	@$(KIBOT_CMD) -s all gerber-zip-file 2>> $(LOGFILE)

.PHONY: all pre_sch out_sch all_sch pre_pcb out_pcb all_pcb run_erc update_xml run_drc gerbers drills bom JLCPCB_position sch_svg sch_pdf pcb_svg_f pcb_svg_b pcb_pdf_f pcb_pdf_b ibom step dxf gerber-zip-file
